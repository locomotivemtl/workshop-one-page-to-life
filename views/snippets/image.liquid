{%- comment -%} -------------------------------- {%- endcomment -%}
{%- comment -%} ------------ PROPS ------------- {%- endcomment -%}
{%- comment -%} ------------------------------- {%- endcomment -%}
{% liquid
    assign _width = width | default: nil
    assign _height = height | default: nil

    assign _src = src | default: nil
    assign _alt = alt | default: nil
    assign _attr = attr | default: nil

    assign _is_figure = is_figure | default: false
    assign _is_lazy = is_lazy | default: true, allow_false: true

    if _is_figure
        assign _tag = 'figure'
    else
        assign _tag = 'div'
    endif
%}

{%- comment -%} ---------------------------------- {%- endcomment -%}
{%- comment -%} ------------ CLASSES ------------- {%- endcomment -%}
{%- comment -%} ------------------------------- {%- endcomment -%}
{% liquid
    assign _classes = classes | default: nil
    assign _modifiers = modifiers | default: nil

    if _is_lazy
        assign _modifiers = _modifiers | append: ' -lazy-load'
    endif

    if _classes != nil
        assign _classes = ' ' | append: _classes
    endif

    if _modifiers != nil
        assign _classes = ' ' | append: _modifiers | append: ' ' | append: _classes
    endif
%}

{%- comment -%} ------------------------------- {%- endcomment -%}
{%- comment -%} ---------- TEMPLATE ----------- {%- endcomment -%}
{%- comment -%} ------------------------------- {%- endcomment -%}
{% if _src %}
    <{{ _tag }} class="c-image{{ _classes }}" {{ _attr }}>
        <img
            class="c-image_img"
            alt="{{ _alt }}"
            width="{{ _width }}"
            height="{{ _height }}"
            src="{{ _src }}"
            {% if _is_lazy %}
                loading="lazy"
                onload="this.classList.add('is-loaded'); this.parentNode.classList.add('is-loaded');"
            {% endif %}
        >
    </{{ _tag }}>
{% endif %}
